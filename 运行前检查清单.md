# 运行前检查清单

## ✅ 配置检查

在运行项目前，请确认以下配置：

### 1. 环境变量配置（.env 或 .env.local）

确认以下 4 个参数都已正确填写：

```bash
COS_SECRET_ID=你的实际SecretId
COS_SECRET_KEY=你的SecretKey（长字符串）
COS_BUCKET=你的存储桶名称（格式：名称-APPID）
COS_REGION=你的地域代码（格式：ap-xxx）
```

**检查方法：**
- [ ] COS_SECRET_ID 已填写（格式：以特定前缀开头的字符串）
- [ ] COS_SECRET_KEY 是长字符串（不是示例值）
- [ ] COS_BUCKET 包含 APPID（格式：`xxx-1250000000`）
- [ ] COS_REGION 是有效的地域代码（如：`ap-beijing`）

### 2. 依赖安装

确认已安装所有依赖：

```bash
npm install
```

**检查方法：**
- [ ] 运行 `npm list cos-nodejs-sdk-v5` 能看到版本号
- [ ] `node_modules` 目录存在且包含 `cos-nodejs-sdk-v5`

### 3. 存储桶权限

在腾讯云控制台确认：

- [ ] 存储桶已创建
- [ ] 存储桶权限设置为 **私有读写**
- [ ] API 密钥有 COS 上传权限

---

## 🚀 运行步骤

### 1. 安装依赖（如果还没安装）

```bash
npm install
```

### 2. 启动开发服务器

```bash
npm run dev
```

### 3. 访问应用

打开浏览器访问：http://localhost:3000

---

## 🧪 测试上传功能

### 测试步骤：

1. **连接钱包**
   - 点击右上角"连接钱包"按钮
   - 使用 MetaMask 连接

2. **进入录入页面**
   - 点击导航栏"录入"
   - 选择"句子录入"

3. **录制音频**
   - 等待系统预热完成（显示"系统已就绪"）
   - 点击绿色按钮开始录音
   - 录制 5 个句子

4. **提交录音**
   - 完成所有句子后，点击"提交录音"按钮
   - 观察按钮文字变化：
     - "正在准备下载..."
     - "正在上传到云端..."
     - "上传完成！成功 X 个"

5. **验证上传**
   - 检查浏览器控制台是否有错误
   - 检查是否显示上传成功提示
   - 在腾讯云控制台查看存储桶中是否有文件

---

## 🔍 故障排查

### 问题 1：依赖安装失败

**错误信息：** `Cannot find module 'cos-nodejs-sdk-v5'`

**解决方法：**
```bash
npm install cos-nodejs-sdk-v5
```

### 问题 2：环境变量未加载

**错误信息：** `COS_SECRET_ID is not defined`

**解决方法：**
- 确认 `.env` 或 `.env.local` 文件在项目根目录
- 确认文件名称正确（不是 `.env.example`）
- 重启开发服务器：`npm run dev`

### 问题 3：上传失败

**错误信息：** `上传失败: xxx`

**检查清单：**
- [ ] 环境变量是否正确填写
- [ ] 存储桶名称和地域是否正确
- [ ] API 密钥是否有权限
- [ ] 存储桶权限是否为私有读写
- [ ] 网络连接是否正常

**查看详细错误：**
- 打开浏览器开发者工具（F12）
- 查看 Console 标签页的错误信息
- 查看 Network 标签页的请求详情

### 问题 4：钱包未连接

**提示：** "连接钱包后可自动上传到云端存储"

**解决方法：**
- 安装 MetaMask 浏览器扩展
- 点击"连接钱包"按钮
- 在 MetaMask 中确认连接

---

## 📝 成功标志

如果一切正常，你应该看到：

1. ✅ 开发服务器启动成功
2. ✅ 页面正常加载
3. ✅ 钱包可以连接
4. ✅ 录音功能正常
5. ✅ 上传时显示"正在上传到云端..."
6. ✅ 上传成功后显示"上传完成！成功 X 个"
7. ✅ 在腾讯云控制台可以看到上传的文件

---

## 🎯 下一步

配置完成后，你可以：

1. 测试完整的录音和上传流程
2. 查看上传历史（保存在 localStorage）
3. 使用预签名 URL 访问上传的文件
4. 根据需要调整上传逻辑
